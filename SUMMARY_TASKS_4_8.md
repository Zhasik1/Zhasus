# üìä –ó–ê–î–ê–ù–ò–Ø 4-8: –ê–ù–ê–õ–ò–ó –¢–†–ê–ù–ó–ê–ö–¶–ò–ô

## ‚úÖ –°–¢–ê–¢–£–°: –í–°–ï –§–ê–ô–õ–´ –°–û–ó–î–ê–ù–´ –ò –ì–û–¢–û–í–´ –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

### üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è:
- **`task4.py`** - –°—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω–∞ –ø–æ amount –¥–ª—è —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- **`task5.py`** - –†–∞–∑–Ω–∏—Ü–∞ –≤ —Ç—Ä–∞—Ç–∞—Ö –∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è—Ö –ø–æ –ø–æ–ª–∞–º
- **`task6.py`** - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ –ø–æ —Ç–∏–ø–∞–º –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª–æ–≤
- **`task7.py`** - –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–Ω–∏—Ü—ã –≤ —Ç—Ä–∞—Ç–∞—Ö –ø–æ MCC –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- **`task8.py`** - –ê–Ω–∞–ª–∏–∑ –Ω–æ—á–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (00:00-06:00)

#### –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:
- **`master_analysis.py`** - ‚≠ê –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- **`examples_4_8.py`** - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- **`GUIDE_TASKS_4_8.py`** - üìö –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏

#### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- **`TASKS_4_8_README.md`** - –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π
- **`SUMMARY_TASKS_4_8.md`** - –≠—Ç–æ—Ç —Ñ–∞–π–ª

---

## üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢

### 1Ô∏è‚É£ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å 4 CSV —Ñ–∞–π–ª–∞:
```
transactions.csv       - –¢–∞–±–ª–∏—Ü–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
gender_train.csv       - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
tr_mcc_codes.csv       - MCC –∫–æ–¥—ã –∏ –æ–ø–∏—Å–∞–Ω–∏—è
tr_types.csv           - –¢–∏–ø—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
```

### 2Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π —Å—Ä–∞–∑—É

```bash
python3 master_analysis.py
```

### 3Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è

```bash
python3 task4.py      # –°—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω–∞
python3 task5.py      # –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –ø–æ–ª–∞–º
python3 task6.py      # –ú–∞–∫—Å –¥–æ—Ö–æ–¥
python3 task7.py      # MCC –∞–Ω–∞–ª–∏–∑
python3 task8.py      # –ù–æ—á–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
```

### 4Ô∏è‚É£ –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–∏–º–µ—Ä–æ–≤

```bash
python3 examples_4_8.py
python3 GUIDE_TASKS_4_8.py
```

---

## üìã –û–ü–ò–°–ê–ù–ò–ï –ö–ê–ñ–î–û–ì–û –ó–ê–î–ê–ù–ò–Ø

### **–ó–ê–î–ê–ù–ò–ï 4: –°—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω–∞ –ø–æ amount**

| –ß–∞—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|-------|---------|-------------------|
| 1 | –°—Ä–µ–¥–Ω–µ–µ/–º–µ–¥–∏–∞–Ω–∞ –¥–ª—è —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ —Ç–æ–ø-10 —Ä–µ–≥–∏–æ–Ω–∞—Ö | DataFrame —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏: '—Å—Ä–µ–¥–Ω–µ–µ', '–º–µ–¥–∏–∞–Ω–∞' |
| 2 | –°—Ä–µ–¥–Ω–µ–µ/–º–µ–¥–∏–∞–Ω–∞ –¥–ª—è —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ –ø–æ–ª–∞–º | DataFrame —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ (gender, tr_type) |

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `groupby()` - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞
- `.agg(['mean', 'median'])` - –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ
- `nlargest()` - —Ç–æ–ø-10 —Ä–µ–≥–∏–æ–Ω–æ–≤

---

### **–ó–ê–î–ê–ù–ò–ï 5: –†–∞–∑–Ω–∏—Ü–∞ –≤ —Ç—Ä–∞—Ç–∞—Ö –∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è—Ö –ø–æ –ø–æ–ª–∞–º**

| –ß–∞—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –§–æ—Ä–º—É–ª–∞ |
|-------|---------|---------|
| 1 | –ú–æ–¥—É–ª—å —Ä–∞–∑–Ω–∏—Ü—ã —Å—Ä–µ–¥–Ω–∏—Ö –¢–†–ê–¢ | `abs(avg_spending[gender1] - avg_spending[gender2])` |
| 2 | –ú–æ–¥—É–ª—å —Ä–∞–∑–Ω–∏—Ü—ã —Å—Ä–µ–¥–Ω–∏—Ö –ü–û–°–¢–£–ü–õ–ï–ù–ò–ô | `abs(avg_income[gender1] - avg_income[gender2])` |

**–£—Å–ª–æ–≤–∏—è:**
- –¢—Ä–∞—Ç—ã: `amount < 0`
- –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è: `amount > 0`

---

### **–ó–ê–î–ê–ù–ò–ï 6: –ú–∞–∫—Å –¥–æ—Ö–æ–¥ –ø–æ —Ç–∏–ø–∞–º –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª–æ–≤**

| –ß–∞—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –í—ã–≤–æ–¥ |
|-------|---------|-------|
| 1 | –¢–æ–ø-10 —Ç–∏–ø–æ–≤ —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º –º–∞–∫—Å –¥–æ—Ö–æ–¥–æ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª–∞ | 2 —Å–ø–∏—Å–∫–∞ –ø–æ 10 —Ç–∏–ø–æ–≤ |
| 2 | –û–±—â–∏–µ —Ç–∏–ø—ã –º–µ–∂–¥—É –ø–æ–ª–∞–º–∏ | –¢–∏–ø—ã, –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è –≤ –æ–±–æ–∏—Ö —Å–ø–∏—Å–∫–∞—Ö |

**–ú–µ—Ç–æ–¥:**
```python
max_inc.groupby('gender')['tr_type'].nsmallest(10, 'max_income')
```

---

### **–ó–ê–î–ê–ù–ò–ï 7: –†–∞–∑–Ω–∏—Ü–∞ –≤ —Ç—Ä–∞—Ç–∞—Ö –ø–æ MCC –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º**

| –ß–∞—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –§–æ—Ä–º—É–ª–∞ |
|-------|---------|---------|
| 1 | –°—É–º–º—ã –∑–∞—Ç—Ä–∞—Ç –ø–æ MCC –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª–∞ | `sum(amount < 0)` –ø–æ (gender, mcc_code) |
| 2 | –¢–æ–ø-10 MCC —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π —Ä–∞–∑–Ω–∏—Ü–µ–π | `abs(sum[gender1] - sum[gender2])` |

**–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:**
- MCC –∫–æ–¥
- –û–ø–∏—Å–∞–Ω–∏–µ MCC
- –†–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –ø–æ–ª–∞–º–∏

---

### **–ó–ê–î–ê–ù–ò–ï 8: –ù–æ—á–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (00:00-06:00)**

| –ß–∞—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ |
|-------|---------|---------|
| 1 | –í—ã–¥–µ–ª–µ–Ω–∏–µ —á–∞—Å–∞ –∏–∑ datetime | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.dt.hour` |
| 2 | –ü–æ–¥—Å—á–µ—Ç –Ω–æ—á–Ω—ã—Ö –¢–†–ê–¢ –ø–æ –ø–æ–ª–∞–º | `tr_hour in [0,1,2,3,4,5]` AND `amount < 0` |

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
gender1: 1234 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
gender2: 5678 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
```

---

## üîß –ü–û–î–ì–û–¢–û–í–ö–ê –î–ê–ù–ù–´–•

### –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞

```python
import pandas as pd

transactions = pd.read_csv('transactions.csv')
gender_train = pd.read_csv('gender_train.csv')
tr_mcc_codes = pd.read_csv('tr_mcc_codes.csv')
tr_types = pd.read_csv('tr_types.csv')
```

### –®–∞–≥ 2: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ (–í–ê–ñ–ù–û! –ü–æ—Ä—è–¥–æ–∫ —Å—Ç—Ä–æ–≥–∏–π)

```python
# LEFT JOIN —Å gender_train (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
transactions = pd.merge(transactions, gender_train, how='left')

# INNER JOIN —Å tr_mcc_codes (–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ)
transactions = pd.merge(transactions, tr_mcc_codes, how='inner')

# INNER JOIN —Å tr_types (–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ)
transactions = pd.merge(transactions, tr_types, how='inner')

# –ü—Ä–æ–≤–µ—Ä–∫–∞
assert transactions.shape[0] == 999584, f"–û–∂–∏–¥–∞–µ—Ç—Å—è 999584 —Å—Ç—Ä–æ–∫, –ø–æ–ª—É—á–µ–Ω–æ {transactions.shape[0]}"
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```python
print(transactions.shape)        # (999584, N)
print(transactions.columns)      # –í—Å–µ –ª–∏ –∫–æ–ª–æ–Ω–∫–∏?
print(transactions.dtypes)       # –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ª–∏ —Ç–∏–ø—ã?
print(transactions.head())       # –í—ã–≥–ª—è–¥–∏—Ç –ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ?
```

---

## üí° –ö–õ–Æ–ß–ï–í–´–ï –ö–û–ù–¶–ï–ü–¶–ò–ò

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Å–ª–æ–≤–∏—è–º

```python
# –¢–æ–ª—å–∫–æ —Ç—Ä–∞—Ç—ã (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)
spendings = transactions[transactions['amount'] < 0]

# –¢–æ–ª—å–∫–æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)
incomes = transactions[transactions['amount'] > 0]

# –¢–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —á–∞—Å—ã
night = transactions[transactions['tr_hour'].isin(range(0, 6))]

# –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ
night_spendings = transactions[
    (transactions['tr_hour'].isin(range(0, 6))) & 
    (transactions['amount'] < 0)
]
```

### –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è

```python
# –ü–æ –æ–¥–Ω–æ–π –∫–æ–ª–æ–Ω–∫–µ
result = df.groupby('gender')['amount'].mean()

# –ü–æ –¥–≤—É–º –∫–æ–ª–æ–Ω–∫–∞–º
result = df.groupby(['gender', 'tr_type'])['amount'].sum()

# –ù–µ—Å–∫–æ–ª—å–∫–æ –∞–≥—Ä–µ–≥–∞—Ü–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
result = df.groupby('gender')['amount'].agg(['sum', 'mean', 'median', 'count'])
```

### –†–∞–±–æ—Ç–∞ —Å datetime

```python
# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ datetime (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
df['tr_datetime'] = pd.to_datetime(df['tr_datetime'])

# –í—ã–¥–µ–ª–µ–Ω–∏–µ —á–∞—Å–∞
df['tr_hour'] = df['tr_datetime'].dt.hour  # –ó–Ω–∞—á–µ–Ω–∏—è 0-23

# –í—ã–¥–µ–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
df['date'] = df['tr_datetime'].dt.date
df['day'] = df['tr_datetime'].dt.day
df['month'] = df['tr_datetime'].dt.month
```

### –ú–æ–¥—É–ª—å –∏ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

```python
# –ú–æ–¥—É–ª—å —Ä–∞–∑–Ω–∏—Ü—ã
diff = abs(value1 - value2)

# –í DataFrame
df['abs_amount'] = abs(df['amount'])
df['difference'] = abs(df['col1'] - df['col2'])
```

---

## ‚ö†Ô∏è –ß–ê–°–¢–´–ï –û–®–ò–ë–ö–ò

### ‚ùå –û—à–∏–±–∫–∞ 1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ merge
```python
# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
transactions = pd.merge(transactions, tr_types, how='inner')
transactions = pd.merge(transactions, gender_train, how='left')
transactions = pd.merge(transactions, tr_mcc_codes, how='inner')

# –ü–†–ê–í–ò–õ–¨–ù–û
transactions = pd.merge(transactions, gender_train, how='left')
transactions = pd.merge(transactions, tr_mcc_codes, how='inner')
transactions = pd.merge(transactions, tr_types, how='inner')
```

### ‚ùå –û—à–∏–±–∫–∞ 2: –ó–∞–±—ã–ª–∏ abs() –¥–ª—è –º–æ–¥—É–ª—è
```python
# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
diff = avg1 - avg2  # –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º

# –ü–†–ê–í–ò–õ–¨–ù–û
diff = abs(avg1 - avg2)  # –í—Å–µ–≥–¥–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π
```

### ‚ùå –û—à–∏–±–∫–∞ 3: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —á–∞—Å–∞
```python
# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
hour = int(df['tr_datetime'].str[:2])  # –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

# –ü–†–ê–í–ò–õ–¨–ù–û
df['tr_hour'] = df['tr_datetime'].dt.hour  # –ü—Ä–∞–≤–∏–ª—å–Ω–æ
```

### ‚ùå –û—à–∏–±–∫–∞ 4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω wrong join type
```python
# –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ 999584 —Å—Ç—Ä–æ–∫, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫:
# LEFT join: –æ—Å—Ç–∞–≤–ª—è–µ—Ç –í–°–ï —Å—Ç—Ä–æ–∫–∏ –∏–∑ –ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã
# INNER join: –æ—Å—Ç–∞–≤–ª—è–µ—Ç –¢–û–õ–¨–ö–û —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏
```

---

## üìä –ü–†–ò–ú–ï–† –ü–û–õ–ù–û–ì–û –†–ï–®–ï–ù–ò–Ø (–ó–ê–î–ê–ù–ò–ï 5)

```python
import pandas as pd

# –ó–∞–≥—Ä—É–∑–∫–∞
transactions = pd.read_csv('transactions.csv')
gender_train = pd.read_csv('gender_train.csv')
tr_mcc_codes = pd.read_csv('tr_mcc_codes.csv')
tr_types = pd.read_csv('tr_types.csv')

# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ
transactions = pd.merge(transactions, gender_train, how='left')
transactions = pd.merge(transactions, tr_mcc_codes, how='inner')
transactions = pd.merge(transactions, tr_types, how='inner')

print(f"–¢–∞–±–ª–∏—Ü–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞: {transactions.shape}")

# ===== –ó–ê–î–ê–ù–ò–ï 5, –ß–ê–°–¢–¨ 1 =====
print("\n=== –ó–ê–î–ê–ù–ò–ï 5, –ß–ê–°–¢–¨ 1 ===")
print("–ú–æ–¥—É–ª—å —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É —Å—Ä–µ–¥–Ω–∏–º–∏ —Ç—Ä–∞—Ç–∞–º–∏ –∂–µ–Ω—â–∏–Ω –∏ –º—É–∂—á–∏–Ω")

# –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç—Ä–∞—Ç—ã
spendings = transactions[transactions['amount'] < 0]

# –°—Ä–µ–¥–Ω–∏–µ —Ç—Ä–∞—Ç—ã –ø–æ –ø–æ–ª–∞–º
avg_spending = spendings.groupby('gender')['amount'].mean()
print(f"\n–°—Ä–µ–¥–Ω–∏–µ —Ç—Ä–∞—Ç—ã –ø–æ –ø–æ–ª–∞–º:")
print(avg_spending)

# –ú–æ–¥—É–ª—å —Ä–∞–∑–Ω–∏—Ü—ã
diff_spending = abs(avg_spending.iloc[0] - avg_spending.iloc[1])
print(f"\n–ú–æ–¥—É–ª—å —Ä–∞–∑–Ω–∏—Ü—ã: {diff_spending:.2f}")

# ===== –ó–ê–î–ê–ù–ò–ï 5, –ß–ê–°–¢–¨ 2 =====
print("\n=== –ó–ê–î–ê–ù–ò–ï 5, –ß–ê–°–¢–¨ 2 ===")
print("–ú–æ–¥—É–ª—å —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É —Å—Ä–µ–¥–Ω–∏–º–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è–º–∏ —É –º—É–∂—á–∏–Ω –∏ –∂–µ–Ω—â–∏–Ω")

# –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è
incomes = transactions[transactions['amount'] > 0]

# –°—Ä–µ–¥–Ω–∏–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –ø–æ –ø–æ–ª–∞–º
avg_income = incomes.groupby('gender')['amount'].mean()
print(f"\n–°—Ä–µ–¥–Ω–∏–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –ø–æ –ø–æ–ª–∞–º:")
print(avg_income)

# –ú–æ–¥—É–ª—å —Ä–∞–∑–Ω–∏—Ü—ã
diff_income = abs(avg_income.iloc[0] - avg_income.iloc[1])
print(f"\n–ú–æ–¥—É–ª—å —Ä–∞–∑–Ω–∏—Ü—ã: {diff_income:.2f}")
```

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢–´

–ö–∞–∂–¥–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:

### –ó–∞–¥–∞–Ω–∏–µ 4
```
—Å—Ä–µ–¥–Ω–µ–µ  –º–µ–¥–∏–∞–Ω–∞
tr_type1  1000.5   950.0
tr_type2  2500.3  2300.5
...
```

### –ó–∞–¥–∞–Ω–∏–µ 5
```
–ú–æ–¥—É–ª—å —Ä–∞–∑–Ω–∏—Ü—ã –≤ —Ç—Ä–∞—Ç–∞—Ö: 123.45
–ú–æ–¥—É–ª—å —Ä–∞–∑–Ω–∏—Ü—ã –≤ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è—Ö: 456.78
```

### –ó–∞–¥–∞–Ω–∏–µ 6
```
–û–±—â–∏–µ —Ç–∏–ø—ã: {'type1', 'type2', 'type3'}
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 3
```

### –ó–∞–¥–∞–Ω–∏–µ 7
```
MCC –∫–æ–¥: –æ–ø–∏—Å–∞–Ω–∏–µ - —Ä–∞–∑–Ω–∏—Ü–∞: 50000.00
MCC –∫–æ–¥: –æ–ø–∏—Å–∞–Ω–∏–µ - —Ä–∞–∑–Ω–∏—Ü–∞: 45000.00
...
```

### –ó–∞–¥–∞–Ω–∏–µ 8
```
gender1: 1234 –Ω–æ—á–Ω—ã–µ —Ç—Ä–∞—Ç—ã
gender2: 5678 –Ω–æ—á–Ω—ã–µ —Ç—Ä–∞—Ç—ã
```

---

## üìû –ü–û–ú–û–©–¨

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã:

1. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ `GUIDE_TASKS_4_8.py` - —Ç–∞–º –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ `examples_4_8.py` - —Ç–∞–º –≥–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `master_analysis.py` - —Ç–∞–º –ø–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

---

## ‚ú® –§–ò–ù–ê–õ–¨–ù–ê–Ø –°–í–û–î–ö–ê

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|------|---------|--------|
| task4.py | –°—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω–∞ | ‚úÖ –ì–æ—Ç–æ–≤ |
| task5.py | –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –ø–æ–ª–∞–º | ‚úÖ –ì–æ—Ç–æ–≤ |
| task6.py | –ú–∞–∫—Å –¥–æ—Ö–æ–¥ | ‚úÖ –ì–æ—Ç–æ–≤ |
| task7.py | MCC –∞–Ω–∞–ª–∏–∑ | ‚úÖ –ì–æ—Ç–æ–≤ |
| task8.py | –ù–æ—á–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ | ‚úÖ –ì–æ—Ç–æ–≤ |
| master_analysis.py | –í—Å–µ –≤–º–µ—Å—Ç–µ | ‚úÖ –ì–æ—Ç–æ–≤ |
| examples_4_8.py | –ü—Ä–∏–º–µ—Ä—ã | ‚úÖ –ì–æ—Ç–æ–≤ |
| GUIDE_TASKS_4_8.py | –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ | ‚úÖ –ì–æ—Ç–æ–≤ |

**–í—Å–µ —Ñ–∞–π–ª—ã –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ
