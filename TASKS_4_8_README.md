# Задания 4-8: Анализ транзакций

## Описание файлов

- **task4.py** - Среднее и медиана по amount для типов транзакций
- **task5.py** - Разница в тратах и поступлениях по полам
- **task6.py** - Макс доход по типам транзакций для разных полов
- **task7.py** - Анализ разницы в тратах по MCC категориям
- **task8.py** - Анализ ночных транзакций (00:00-06:00)
- **master_analysis.py** - Комплексный скрипт, выполняющий все задания

## Необходимые данные

Для выполнения заданий требуются следующие файлы CSV:
1. `transactions.csv` - Таблица транзакций
2. `gender_train.csv` - Информация о поле клиентов
3. `tr_mcc_codes.csv` - Таблица MCC кодов
4. `tr_types.csv` - Таблица типов транзакций

## Как запустить

### Вариант 1: Запустить все задания сразу

```bash
python3 master_analysis.py
```

### Вариант 2: Запустить отдельные задания

```bash
python3 task4.py
python3 task5.py
python3 task6.py
python3 task7.py
python3 task8.py
```

## Структура данных после объединения

```python
transactions = pd.merge(transactions, gender_train, how='left')      # левое объединение
transactions = pd.merge(transactions, tr_mcc_codes, how='inner')     # внутреннее объединение
transactions = pd.merge(transactions, tr_types, how='inner')         # внутреннее объединение
# Итого: 999584 строк
```

## Содержание заданий

### Задание 4
1. Среднее и медиана по amount для типов транзакций из топ-10 регионов
2. Среднее и медиана по amount для типов транзакций по полам

### Задание 5
1. Модуль разницы между средними тратами женщин и мужчин
2. Модуль разницы между средними поступлениями мужчин и женщин

### Задание 6
1. Максимальный доход по типам транзакций (отдельно для мужчин и женщин)
2. Типы транзакций, встречающиеся одновременно у обоих полов

### Задание 7
1. Суммы затрат по каждой MCC категории для мужчин и женщин
2. Топ-10 MCC категорий с наибольшей разницей в тратах

### Задание 8
1. Выделение часа из поля tr_datetime
2. Количество ночных транзакций (00:00-06:00) со тратами (amount < 0) по полам

## Примечания

- **Траты** - это отрицательные значения в столбце `amount` (amount < 0)
- **Поступления** - это положительные значения в столбце `amount` (amount > 0)
- **Ночное время** - часы с 00:00 по 06:00 (часы 0-5)
- Все модули разниц вычисляются как `abs(значение1 - значение2)`

## Результаты

Все результаты выводятся в консоль. Для сохранения результатов в файлы, модифицируйте код:

```python
result.to_csv('output_name.csv')
```
